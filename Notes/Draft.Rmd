
<style type="text/css">

.table {
    width: 80%;
}

p {text-align: justify;}

blockquote {
    display: block;
    margin-top: 1em;
    margin-bottom: 1em;
    margin-left: 40px;
    margin-right: 40px;
    font-size: 14px;
}
</style>

```{r echo=FALSE}
knitr::read_chunk('testcode.R')
```

```{r first, cache=FALSE, echo=FALSE, results='hide', message = FALSE,warning=FALSE}
<<main>>
```

```{r cache=FALSE, echo=FALSE,include=FALSE}
options(scipen=1,digits = 1)
```


# Rugby Wanderers
###### [Hautahi Kingi](http://www.hautahikingi.com)
<br>
Rugby is a passionate affair, both on and off the field, and controversy never lingers far away. Was rugby [complicit](https://en.wikipedia.org/wiki/1981_South_Africa_rugby_union_tour) in [apartheid](http://www.teara.govt.nz/en/photograph/26666/all-white-all-blacks-1928)? Whatever happened to [Keith Murdoch](http://www.smh.com.au/rugby-union/union-news/the-murdoch-myth-all-blacks-legend-lives-life-of-a-recluse-after-infamous-punch-20111020-1mb2p.html)? Did [Suzie the waitress](https://en.wikipedia.org/wiki/1995_Rugby_World_Cup_Final) really stoop so low?  One recent and heated controversy concerns the extent to which international rugby teams "poach" players from other countries. The ongoing debate among the international rugby public and media has largely relied on casual observations and anecdotes rather than evidence.^[Here are a few examples: [1](http://www.telegraph.co.uk/sport/rugbyunion/2361788/Ruthless-All-Blacks-harvest-fertile-Island-talent.html), [2](http://www.dailymail.co.uk/sport/rugbyunion/article-2612324/All-Blacks-remember-players-theyve-poached-Pacific-Islands.html), [3](http://www.thesundaytimes.co.uk/sto/sport/article137252.ece), [4](http://www.telegraph.co.uk/sport/rugbyunion/international/newzealand/11113937/New-Zealand-owe-a-debt-to-Samoa-that-can-only-be-repaid-with-a-full-touring-party-for-long-overdue-first-Test-visit.html), [5](http://www.theroar.com.au/2012/10/31/the-problem-with-eligibility-in-international-rugby/), [6](http://www.stuff.co.nz/sport/rugby/opinion/10132272/Gifford-Home-truths-about-Pasifika-poaching), [7](http://www.stuff.co.nz/13313/All-Blacks-accused-of-Pacific-pillage-again). The [New Zealand Herald](http://www.nzherald.co.nz/sport/news/article.cfm?c_id=4&objectid=11278276) provided a notable exception by compiling a dataset of the birthplace of every [All Black](https://en.wikipedia.org/wiki/New_Zealand_national_rugby_union_team) prior to 2014.] 

<!--
Surely Bob Deans scored [that try](http://www.rugbyfootballhistory.com/that1905try.html)?
-->

> "The most savage controversies are those about matters as to which there is no good evidence either way"
>  <footer align="right"> [Bertrand Russell](http://www.personal.kent.edu/~rmuhamma/Philosophy/RBwritings/outIntellectRubbish.htm) </footer> 

In the hope of easing the savagery, I construct a dataset of every international rugby player to have played for the major test nations. Along with names and playing statistics, I also gather birthplace information which allows me to answer questions like "Which country poaches the most players?" and "Where are these players coming from?". To anyone familiar with the tone of the usual [accusations](http://www.thesundaytimes.co.uk/sto/sport/article137252.ece) and [allegations](http://www.telegraph.co.uk/sport/rugbyunion/2361788/Ruthless-All-Blacks-harvest-fertile-Island-talent.html), the following results may be surprising:

* At least `r TotalExports ` players have made their debut for foreign national teams since the advent of the professional era in 1996. Of these, `r d9[1,2]` were born in New Zealand, followed by England with `r d9[2,2]`, and South Africa and Australia with `r d9[3,2]` each.

* `r d3[1,5]`% of people to debut for Samoa since 1996 were not born in Samoa. `r d_wide$NewZealand[d_wide$Team=="Samoa"]` of these `r d3[1,4]` players were born in New Zealand.

* Of the "major nations", Scotland is the most guilty of poaching. Since 1996, `r d3[2,5]`% of players making their debut were not born in Scotland. Next is Italy with `r d3[5,5]`%, Ireland with `r d3[7,5]`%, Australia with `r d3[8,5]`% and England with `r d3[9,5]`%.

* Argentina is the least guilty of poaching with just `r d3[16,5]`% of its players born overseas, followed by South Africa with `r d3[15,5]`%, France with `r d3[14,5]`% and New Zealand with `r d3[12,5]`%.

* Compared to their general populations, only Argentina and New Zealand are *under*-represented when it comes to foreign born players. `r m1[m1$Team=="NewZealand",2]`% of New Zealand's population is foreign born, while just `r m1[m1$Team=="NewZealand",3]`% of its players are. Similarly, `r m1[m1$Team=="Argentina",2]`% of Argentina's general population is foreign born, compared to `r m1[m1$Team=="Argentina",3]`% of its players. Every other nation has more foreign-born players than would be expected given the foreign born composition of their general populations.



```{r cache=FALSE, echo=FALSE,include=FALSE}
player1 <- "Ronan O'Gara"
```

A couple things before diving into more detail. In this write-up, I limit the analysis to players who made their test debut within the post-`r cutoff+1` profesional era. Not only is this time period more relevant to the current discussion, but data quality significantly deteriorates prior to `r cutoff+1` (more detail on this [below](#data)). I also define foreign players as those who were not born in the country for which they play. I'm aware of many objections to this definition. [Andrew Mertens](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/NewZealand.csv#L639), for example, scored `r df$Points[df$Name=="Andrew Mehrtens"]` points over `r df$Matches[df$Name=="Andrew Mehrtens"]` tests for the All Blacks, and is considered one of the best first-fives of his generation. He grew up in New Zealand and few would question his "credentials" as a New Zealand-produced rugby talent. However, he was born in South Africa, so in my analysis he is classified as a rugby import. Sticking with the first-five position, [`r player1`](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Ireland.csv#L957), who scored `r df$Points[df$Name==player1]` points for `r df$Team[df$Name==player1]` is also considered an import because he was born in the United States. An argument could certainly be made for criteria such as citizenship or where the player spent the majority of his childhood, in which case both of the above examples would rightly be considered "native-born" players. Nevertheless, no definition is without controversy, and I'm somewhat limited by data availability, so I'm sticking with this definition for now.

```{r cache=FALSE, echo=FALSE,include=FALSE}
temp <- d %>% filter(is.na(Birthcountry)) %>% select(Name)
miss <- length(temp$Name)
rm(temp)
```

Finally, this remains a work in progress. I am missing the birthplace information for `r miss` of the `r length(d$Name)` players to make their debut in the professional era. You can find out more about the data and help me out [below](#help).


<!--
My data reveals several interesting facts. Of the major rugby nations (Australia, Argentina, England, France, Ireland, New Zealand, Italy, Samoa, Scotland, South Africa and Wales), Samoa have ``imported" the most amount of players. Of the xxx men that have played test rugby for Samoa, xx were foreign born, xx of which were born in New Zealand. On the other side of the scale, New Zealand has exported the highest number of players. xxx New Zealand-born players have appeared for foreign teams, with the second biggest exporter being x with x players.
-->

```{r, results=FALSE,echo=FALSE,warning=FALSE}
excount <- "England"
TotalEng<- d3 %>% filter(Team==excount) %>% select(`Total`)
ForEng<- d3 %>% filter(Team==excount) %>% select(`Foreign Born`)

Samcount <- d3 %>% mutate(count=`Total` - `Missing Birth Information`) %>%
  filter(Team=="Samoa") %>% select(count)
Samperc <- d3 %>% filter(Team=="Samoa") %>% select(`Foreign Born (%)`)

Argcount <- d3 %>% mutate(count=`Total` - `Missing Birth Information`) %>%
  filter(Team=="Argentina") %>% select(count)
Argperc <- d3 %>% filter(Team=="Argentina") %>% select(`Foreign Born (%)`)
```

<br>

#### Rugby Imports

The following table provides an overview of the native vs foreign born breakdown for each country, ordered according to the percentage of players that are foreign born.^[The foreign born percentage reported in the table is calculated by dividing the number of foreign born by the number of players for which I have birthplace data.] `r d3$Team[1]` leads the way as the chief player importer. Of the `r Samcount` players for which I have birthplace information, `r Samperc`% were not born in `r d3$Team[1]`. At the other end of the scale, `r d3$Team[length(d3$Team)]` are the least guilty of player poaching. Of the `r Argcount` players for which I have birthplace information, just `r Argperc`% were not born in `r d3$Team[length(d3$Team)]`.

The last column of the table lists the number of players for which I am missing birthplace information. While I am missing birthplace information for `r sum(d3[,6])` of the `r sum(d3[,2])` players to make their test debut since `r cutoff+1`, `r sum(d3[c(1,3,4,6,11,13),6])` of those players belong to just six of the "minor" teams. After restricting the analysis to the major teams, Scotland is most guilty of poaching, followed by Italy, Ireland, Australia and England. The countries that rely the most on locally produced talent are Wales, New Zealand, France and South Africa.

<br>
<center>

<h4>Table 1: The Foreign vs Native Born Player Split</h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(d3,include.rownames = FALSE,format='d',
            align = c("l","c","c","c","c","r")),type='pandoc')
```
</center>
<br>

That no countries are immune to player poaching is not surprising. International migration is a reality of the modern world, and many of the top rugby countries have large foreign born populations. Many of the poaching criticisms are simply the result of ignorance regarding the ethnic make up of many countries. The following table allows us to compare the extent to which the foreign born composition of each rugby side is representative of the general population in that country. Using 2010 census data compiled by the World Bank, the first column shows the percentage of each country's population that was not born in that country.^[I do not have separate migration data for the British countries. I therefore use the total United Kingdom figure of `r m1[m1$Team=="England",2]`% for each of England, Scotland and Wales.] New Zealand has the highest proportion of its population born overseas, at `r m1[1,2]`%, followed by `r m1[2,1]` with `r m1[2,2]`% and `r m1[3,1]` with `r m1[3,2]`%. The second column repeats the foreign born player percentages from the table above, while the last column gives the ratio of each. A ratio smaller than one indicates that foreign-born players are *under*-represented in the national team. Using this indicator, only New Zealand and Argentina have rugby teams which *under*-represent the foreign-born population. Foreign-born players are *over*-represented for every other country.

<br>
<center>

<h4>
Table 2: Comparison with General Population
<!-- ^[Foreign born population data retrieved from [OECD (2016)](https://data.oecd.org/chart/4uoO), doi: 10.1787/5a368e1b-en (Accessed on 22 March 2016). Figures are from the most recent year available.] -->
^[Foreign born population data were retrieved from the [World Bank Data Bank](http://databank.worldbank.org/data/reports.aspx?source=2&country=ARG&series=&period=#advancedDownloadOptions) (Accessed on 25 March 2016) for the year 2010. The dataset is [here](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/WorldBankData/Data.csv) and details of the definitions and sources for each country can be found [here](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/WorldBankData/DefinitionandSource.csv).]
</h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(m1,include.rownames = FALSE,digits=c(1),
            align = c("l","c","c","c")),type='pandoc')
```
</center>
<br>


```{r, results=FALSE,echo=FALSE,warning=FALSE}
country2 <- "Scotland"
Native2 <- d_wide %>% filter(Team==country2)
```

#### Rugby Exports

So where do these hundreds of foreign born players come from? The next table shows the top 12 "suppliers"" of rugby players to the rest of the world. `r d9[1,2]` New Zealanders have played for another country. The next largest exporter is England with `r d9[2,2]` players. Notable among this list are Germany and Zimbabwe, each of which has provided 9 players to the international rugby community, despite not boasting an international rugby side themselves. Notable absences include Scotland, Ireland and Wales, which have provided fewer than 7 players to other countries, despite having had the services of at least `r d3[d3$Team=="Scotland",4]+d3[d3$Team=="Wales",4]+d3[d3$Team=="England",4]` foreign born players combined.

<br>
<center>
<h4>Table 3: The Great Exporters</h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(d9,include.rownames = FALSE,format=c('s','d'),style=c('d','d'),
            align=c("l","c")),type='pandoc')
```
</center>

The next table summarises the net contribution of each country to the world rugby stock. The final column gives the "trade balance" which is calculated by subtracting the number of "imported" players from the number of "exported" players. A positive trade balance indicates that a country contributes more players to other countries than it "poaches". Leading the way is New Zealand, which has provided `r Trade[1,4]` more players to other countries than it has poached. On the other side of the ledger is Scotland, which has imported `r -Trade[16,4]` more players than it has exported.

<br>
<center>
<h4>Table 4: The Trade Balance</h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(Trade,include.rownames = FALSE,format='d',
            align=c("l","c","c","c")),type='pandoc')
```
</center>
<br>

#### The Interconnectedness of International Rugby

The next table helps us to understand the relationships between each of the countries. Where does country X import most of its players from? Where do the players from country Y go? Each row represents the team while each column represents the country of birth. For example, of the `r Native2$Total` players to debut for `r country2` since `r cutoff+1`, `r Native2$Scotland` were born in Scotland, `r Native2$England` in England, `r Native2$NewZealand` in New Zealand, etc.

<br>
<center>

<h4>Table 5: The Rugby Network </h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(d_wide,include.rownames = FALSE,format='d',
            caption.level=c("s"),
            align=c("l","c","c","c","c","c","c","c","c","c","c","c","c","c","c","c")),type='pandoc')
```

</center>
<br>



#### The Effectiveness of Imports

The final table addresses a common point that is often raised, which is that without imports, some countries would not compete at the same level. While it is true that importing countries get different bang for their buck from their imports, imports tend not to differ too much from their native born teammates.

<br>

<center>
<h4>Table 6: Player Contributions</h4>
<br>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(d6,include.rownames = FALSE, digits=c(1),
            align=c("l","c","c","c","c","c","c")),type='pandoc')
```
</center>

 <!--
<center>
<h5>Table 5: Import Positions</h5>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(posies,include.rownames = FALSE,
            caption.level=c("s"),
            align=c("l","c","c")),type='pandoc')
```
</center>
-->

<br>

## Data

#### <a name="data"></a> How I got it

I scraped the majority of my data from the superb [ESPNscrum](http://www.espnscrum.com) website, which lists the name and statistics for every person to have played a test-match for the major rugby playing nations. As well as match statistics like test matches played, points and tries scored, there is also birth information for the majority of players. However, the birthplace information, where available, is limited to the city of birth. I therefore match the birth cities with their respective countries using the [Geopy](https://pypi.python.org/pypi/geopy) geocoding package in Python. This works well for city names that are unique to a particular country, such as [Taumarunui](https://en.wikipedia.org/wiki/Taumarunui). Trouble can arise in other cases, however. In the case of ambiguous city/country pairs, the Geopy package (to the best of my knowledge) returns the city with the highest population, which leads to errors. For example, the Geopy package attributes those players that were born in the town of Hastings, New Zealand as being born in Hastings, England. I therefore also make manual adjustments to the Python scraped datasets based on my own research. In the case of New Zealand, I use the dataset provided by the [New Zealand Herald](http://www.nzherald.co.nz/sport/news/article.cfm?c_id=4&objectid=11278276) for players making their test debut prior to 2015.

The computer programs that document both the original data scraping and manual adjustments are available at the [Rugby Wanderers Github Repository](https://github.com/hautahi/Rugby-Wanderers).

<br>

#### How you can get it

The full dataset can be found [here](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/1.main_data.csv), or you can view each of the individual team datasets at the following links ([Argentina](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Argentina.csv), [England](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/England.csv), [Australia](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Australia.csv), [New Zealand](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/NewZealand.csv), [Scotland](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Scotland.csv), [Ireland](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Ireland.csv), [Wales](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Wales.csv), [South Africa](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/SouthAfrica.csv), [Japan](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Japan.csv), [Samoa](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Samoa.csv), [Fiji](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Fiji.csv), [Tonga](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Tonga.csv),
[Canada](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Canada.csv), [USA](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/USA.csv), [Italy](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/Italy.csv),
[France](https://github.com/hautahi/Rugby-Wanderers/blob/master/data/France.csv)).

<br>

#### <a name="help"></a> How you can help

To my knowledge, the player names and playing statistics are accurate (as at February 2016), but the birthplace information remains a work in progress. The data is especially sparse for Canada, the USA and the Pacific Island countries. I welcome any contributions and corrections. Feel free to email me (hrk55@cornell.edu) with any help you can provide.

```{r cache=FALSE, echo=FALSE,include=FALSE}
MissingPlayers <- d %>% filter(Team %in% COUNTRY_S,is.na(Birthcountry)) %>%
  select(-Birthplace,-Birthcountry)
```

<!--
<center>
```{r, results='asis',echo=FALSE,warning=FALSE}
library(ascii)
print(ascii(MissingPlayers,include.rownames = FALSE,format='d',
            caption=c('Birth Breakdown by Country'),
            align=c("l","c","c","c","c","c","c","c","c","c","c","c","c","c"),
            caption.level=c("s")),type='pandoc')
```
</center>
-->